/*
 * jScrollPane - v2.0.0beta2 - 2010-08-18
 * http://jscrollpane.kelvinluck.com/
 *
 * Copyright (c) 2010 Kelvin Luck
 * Dual licensed under the MIT and GPL licenses.
 */
(function(b,a,c){b.fn.jScrollPane=function(f){function d(ai,af){var ao,h=this,ae,S,au,X,am,ad,F,q,ar,m,Y,A,p,aq,E,Q,ag,W,o,T,D,ab,G,I,P,n,K,y,ap,z,L,C;L=ai.css("paddingTop")+" "+ai.css("paddingRight")+" "+ai.css("paddingBottom")+" "+ai.css("paddingLeft");C=(parseInt(ai.css("paddingLeft"))||0)+(parseInt(ai.css("paddingRight"))||0);J(af);function J(ax){var aB,aA,az,aw,av,ay;ao=ax;if(ae==c){ai.css({overflow:"hidden",padding:0});S=ai.innerWidth()+C;au=ai.innerHeight();ai.css("width","auto");ae=b('<div class="jspPane" />').wrap(b('<div class="jspContainer" />').css({width:S+"px",height:au+"px"}));ai.wrapInner(ae.parent());X=ai.find(">.jspContainer");ae=X.find(">.jspPane");ae.css("padding",L)}else{ay=ai.outerWidth()!=S||ai.outerHeight()!=au;if(ay){S=ai.innerWidth();au=ai.innerHeight();X.css({width:S+"px",height:au+"px"})}ae.css("width",null);if(!ay&&ae.outerWidth()==am&&ae.outerHeight()==ad){return}X.find(".jspVerticalBar,.jspHorizontalBar").remove().end()}aB=ae.clone().css("position","absolute");aA=b('<div style="width:1px; position: relative;" />').append(aB);b("body").append(aA);am=Math.max(ae.outerWidth(),aB.outerWidth());aA.remove();ad=ae.outerHeight();F=am/S;q=ad/au;ar=q>1;m=F>1;if(!(m||ar)){ai.removeClass("jspScrollable");ae.css("top",0);R();r();u()}else{ai.addClass("jspScrollable");az=ao.maintainPosition&&(p||Q);if(az){aw=j();av=g()}x();ak();k();if(az){w(aw);v(av)}t();at();if(ao.hijackInternalLinks){i()}}if(ao.autoReinitialise&&!z){z=setInterval(function(){J(ao)},ao.autoReinitialiseDelay)}else{if(!ao.autoReinitialise&&z){clearInterval(z)}}}function x(){if(ar){X.append(b('<div class="jspVerticalBar" />').append(b('<div class="jspCap jspCapTop" />'),b('<div class="jspTrack" />').append(b('<div class="jspDrag" />').append(b('<div class="jspDragTop" />'),b('<div class="jspDragBottom" />'))),b('<div class="jspCap jspCapBottom" />')));ag=X.find(">.jspVerticalBar");W=ag.find(">.jspTrack");Y=W.find(">.jspDrag");if(ao.showArrows){ab=b('<a href="#" class="jspArrow jspArrowUp">Scroll up</a>').bind("mousedown.jsp",H(0,-1)).bind("click.jsp",aj);G=b('<a href="#" class="jspArrow jspArrowDown">Scroll down</a>').bind("mousedown.jsp",H(0,1)).bind("click.jsp",aj);if(ao.arrowScrollOnHover){ab.bind("mouseover.jsp",H(0,-1,ab));G.bind("mouseover.jsp",H(0,1,G))}V(W,ao.verticalArrowPositions,ab,G)}T=au;X.find(">.jspVerticalBar>.jspCap:visible,>.jspVerticalBar>.jspArrow").each(function(){T-=b(this).outerHeight()});Y.hover(function(){Y.addClass("jspHover")},function(){Y.removeClass("jspHover")}).bind("mousedown.jsp",function(av){b("html").bind("dragstart.jsp selectstart.jsp",function(){return false});Y.addClass("jspActive");var s=av.pageY-Y.position().top;b("html").bind("mousemove.jsp",function(aw){M(aw.pageY-s,false)}).bind("mouseup.jsp mouseleave.jsp",B);return false});O();ah();l()}else{R()}}function O(){W.height(T+"px");p=0;o=ao.verticalGutter+W.outerWidth();ae.width(S-o-C);if(ag.position().left==0){ae.css("margin-left",o+"px")}}function ak(){if(m){X.append(b('<div class="jspHorizontalBar" />').append(b('<div class="jspCap jspCapLeft" />'),b('<div class="jspTrack" />').append(b('<div class="jspDrag" />').append(b('<div class="jspDragLeft" />'),b('<div class="jspDragRight" />'))),b('<div class="jspCap jspCapRight" />')));I=X.find(">.jspHorizontalBar");P=I.find(">.jspTrack");aq=P.find(">.jspDrag");if(ao.showArrows){y=b('<a href="#" class="jspArrow jspArrowLeft">Scroll left</a>').bind("mousedown.jsp",H(-1,0)).bind("click.jsp",aj);ap=b('<a href="#" class="jspArrow jspArrowRight">Scroll right</a>').bind("mousedown.jsp",H(1,0)).bind("click.jsp",aj);if(ao.arrowScrollOnHover){y.bind("mouseover.jsp",H(-1,0,y));ap.bind("mouseover.jsp",H(1,0,ap))}V(P,ao.horizontalArrowPositions,y,ap)}aq.hover(function(){aq.addClass("jspHover")},function(){aq.removeClass("jspHover")}).bind("mousedown.jsp",function(av){b("html").bind("dragstart.jsp selectstart.jsp",function(){return false
});aq.addClass("jspActive");var s=av.pageX-aq.position().left;b("html").bind("mousemove.jsp",function(aw){N(aw.pageX-s,false)}).bind("mouseup.jsp mouseleave.jsp",B);return false});n=X.innerWidth();ac();an()}else{}}function ac(){X.find(">.jspHorizontalBar>.jspCap:visible,>.jspHorizontalBar>.jspArrow").each(function(){n-=b(this).outerWidth()});P.width(n+"px");Q=0}function k(){if(m&&ar){var av=P.outerHeight(),s=W.outerWidth();T-=av;b(I).find(">.jspCap:visible,>.jspArrow").each(function(){n+=b(this).outerWidth()});n-=s;au-=s;S-=av;P.parent().append(b('<div class="jspCorner" />').css("width",av+"px"));O();ac()}if(m){ae.width((X.outerWidth()-C)+"px")}ad=ae.outerHeight();q=ad/au;if(m){K=1/F*n;if(K>ao.horizontalDragMaxWidth){K=ao.horizontalDragMaxWidth}else{if(K<ao.horizontalDragMinWidth){K=ao.horizontalDragMinWidth}}aq.width(K+"px");E=n-K}if(ar){D=1/q*T;if(D>ao.verticalDragMaxHeight){D=ao.verticalDragMaxHeight}else{if(D<ao.verticalDragMinHeight){D=ao.verticalDragMinHeight}}Y.height(D+"px");A=T-D}}function V(aw,ay,av,s){var aA="before",ax="after",az;if(ay=="os"){ay=/Mac/.test(navigator.platform)?"after":"split"}if(ay==aA){ax=ay}else{if(ay==ax){aA=ay;az=av;av=s;s=az}}aw[aA](av)[ax](s)}function H(av,s,aw){return function(){al(av,s,this,aw);this.blur();return false}}function al(aw,s,az,ay){az=b(az).addClass("jspActive");var ax,av=setInterval(function(){if(aw!=0){N(Q+aw*ao.arrowButtonSpeed,false)}if(s!=0){M(p+s*ao.arrowButtonSpeed,false)}},ao.arrowRepeatFreq);ax=ay==c?"mouseup.jsp":"mouseout.jsp";ay=ay||b("html");ay.bind(ax,function(){az.removeClass("jspActive");clearInterval(av);ay.unbind(ax)})}function B(){b("html").unbind("dragstart.jsp selectstart.jsp mousemove.jsp mouseup.jsp mouseleave.jsp");Y&&Y.removeClass("jspActive");aq&&aq.removeClass("jspActive")}function M(s,av){if(!ar){return}if(s<0){s=0}else{if(s>A){s=A}}if(av==c){av=ao.animateScroll}if(av){h.animate(Y,"top",s,Z)}else{Y.css("top",s);Z(s)}}function Z(av){if(av==c){av=Y.position().top}X.scrollTop(0);p=av;ah();var aw=av/A,s=-aw*(ad-au);ae.css("top",s)}function N(av,s){if(!m){return}if(av<0){av=0}else{if(av>E){av=E}}if(s==c){s=ao.animateScroll}if(s){h.animate(aq,"left",av,aa)}else{aq.css("left",av);aa(av)}}function aa(av){if(av==c){av=aq.position().left}X.scrollTop(0);Q=av;an();var aw=av/E,s=-aw*(am-S);ae.css("left",s)}function ah(){if(ao.showArrows){ab[p==0?"addClass":"removeClass"]("jspDisabled");G[p==A?"addClass":"removeClass"]("jspDisabled")}}function an(){if(ao.showArrows){y[Q==0?"addClass":"removeClass"]("jspDisabled");ap[Q==E?"addClass":"removeClass"]("jspDisabled")}}function v(s,av){var aw=s/(ad-au);M(aw*A,av)}function w(av,s){var aw=av/(am-S);N(aw*E,s)}function U(aD,aB,av){var az,ax,s=0,aw,aA,aC;try{az=b(aD)}catch(ay){return}ax=az.outerHeight();X.scrollTop(0);while(!az.is(".jspPane")){s+=az.position().top;az=az.offsetParent();if(/^body|html$/i.test(az[0].nodeName)){return}}aw=g();aA=aw+au;if(s<aw||aB){aC=s-ao.verticalGutter}else{if(s+ax>aA){aC=s-au+ax+ao.verticalGutter}}if(aC){v(aC,av)}}function j(){return -ae.position().left}function g(){return -ae.position().top}function l(){X.unbind("mousewheel.jsp").bind("mousewheel.jsp",function(s,aw){var av=p;M(p-aw*ao.mouseWheelSpeed,false);return av==p})}function R(){X.unbind("mousewheel.jsp")}function aj(){return false}function t(){ae.find(":input,a").bind("focus.jsp",function(){U(this,false)})}function r(){ae.find(":input,a").unbind("focus.jsp")}function at(){if(location.hash&&location.hash.length>1){var aw,av;try{aw=b(location.hash)}catch(s){return}if(aw.length&&ae.find(aw)){if(X.scrollTop()==0){av=setInterval(function(){if(X.scrollTop()>0){U(location.hash,true);b(document).scrollTop(X.position().top);clearInterval(av)}},50)}else{U(location.hash,true);b(document).scrollTop(X.position().top)}}}}function u(){b("a.jspHijack").unbind("click.jsp-hijack").removeClass("jspHijack")}function i(){u();b("a[href^=#]").addClass("jspHijack").bind("click.jsp-hijack",function(){var s=this.href.split("#"),av;if(s.length>1){av=s[1];if(av.length>0&&ae.find("#"+av).length>0){U("#"+av,true);
return false}}})}b.extend(h,{reinitialise:function(av){av=b.extend({},av,ao);J(av)},scrollToElement:function(aw,av,s){U(aw,av,s)},scrollTo:function(aw,s,av){w(aw,av);v(s,av)},scrollToX:function(av,s){w(av,s)},scrollToY:function(s,av){v(s,av)},scrollBy:function(av,s,aw){h.scrollByX(av,aw);h.scrollByY(s,aw)},scrollByX:function(s,aw){var av=j()+s,ax=av/(am-S);N(ax*E,aw)},scrollByY:function(s,aw){var av=g()+s,ax=av/(ad-au);M(ax*A,aw)},animate:function(av,ay,s,ax){var aw={};aw[ay]=s;av.animate(aw,{duration:ao.animateDuration,ease:ao.animateEase,queue:false,step:ax})},getContentPositionX:function(){return j()},getContentPositionY:function(){return g()},getContentPane:function(){return ae},scrollToBottom:function(s){M(A,s)},hijackInternalLinks:function(){i()}})}f=b.extend({},b.fn.jScrollPane.defaults,f);var e;this.each(function(){var g=b(this),h=g.data("jsp");if(h){h.reinitialise(f)}else{h=new d(g,f);g.data("jsp",h)}e=e?e.add(g):g});return e};b.fn.jScrollPane.defaults={showArrows:false,maintainPosition:true,autoReinitialise:false,autoReinitialiseDelay:500,verticalDragMinHeight:0,verticalDragMaxHeight:99999,horizontalDragMinWidth:0,horizontalDragMaxWidth:99999,animateScroll:false,animateDuration:300,animateEase:"linear",hijackInternalLinks:false,verticalGutter:4,horizontalGutter:4,mouseWheelSpeed:10,arrowButtonSpeed:10,arrowRepeatFreq:100,arrowScrollOnHover:false,verticalArrowPositions:"split",horizontalArrowPositions:"split"}})(jQuery,this);