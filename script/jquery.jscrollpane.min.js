/*
 * jScrollPane - v2.0.0beta1 - 2010-08-02
 * http://jscrollpane.kelvinluck.com/
 *
 * Copyright (c) 2010 Kelvin Luck
 * Dual licensed under the MIT and GPL licenses.
 */
(function(b,a,c){b.fn.jScrollPane=function(f){function d(z,y){var l=this;var B,m,p,t,w,k,C,j,q,h,g,x;savedSettings={};u(y);function u(D){p=z.parent(".jspContainer");if(p.length==0){z.css("overflow","hidden");B=z.innerWidth();m=z.innerHeight();z.css("overflow","visible");z.wrap(b("<div />").addClass("jspContainer").css({width:B+"px",height:m+"px"}));p=z.parent()}else{B=p.outerWidth();m=p.outerHeight();p.find(".jspVerticalBar,.jspHorizontalBar").remove().end()}z.css({width:"auto",height:"auto"});var F=z.clone().css("position","absolute");var E=b('<div style="width:1px; position: relative;" />').append(F);b("body").append(E);t=Math.max(z.outerWidth(),F.outerWidth());E.remove();w=z.outerHeight();k=t/B;C=w/m;j=C>0.99;q=k>1;if(!(q||j)){z.removeClass("jspScrollable");z.css("top",0);o()}else{z.addClass("jspScrollable");A()}}function A(){if(j){p.append(b('<div class="jspVerticalBar" />').append(b('<div class="jspCap jspCapTop" />'),b('<div class="jspTrack" />').append(b('<div class="jspDrag" />').append(b('<div class="jspDragTop" />'),b('<div class="jspDragBottom" />'))),b('<div class="jspCap jspCapBottom" />')));var J=p.find(">.jspVerticalBar");var E=J.find(">.jspTrack");h=E.find(">.jspDrag");var I=J.position().left>0?"right":"left";z.css("margin-"+I,(y.gutter+E.outerWidth())+"px");w=z.outerHeight();C=w/m;if(y.showArrows){var H=b('<a href="#" class="jspArrow jspArrowUp">Scroll up</a>').bind("click",s(0,-1));var D=b('<a href="#" class="jspArrow jspArrowDown">Scroll down</a>').bind("click",s(0,1));E.before(H).after(D)}var G=m;p.find(">.jspVerticalBar>.jspCap,>.jspVerticalBar>.jspArrow").each(function(){G-=b(this).outerHeight()});E.height(G+"px");var F=1/C*G;h.height(F+"px");g=G-F;x=0;h.hover(function(){h.addClass("jspHover")},function(){h.removeClass("jspHover")}).bind("mousedown.jsp",function(L){b("html").bind("dragstart.jsp selectstart.jsp",function(){return false});var K=L.pageY-h.position().top;b("html").bind("mousemove.jsp",function(M){i(M.pageY-K)}).bind("mouseup.jsp mouseleave.jsp",v);return false});r()}else{o()}}function s(E,D){return function(){n(E,D);this.blur();return false}}function n(E,D){console.log("Scrolling",E,D)}function v(){b("html").unbind("dragstart.jsp selectstart.jsp mousemove.jsp mouseup.jsp mouseleave.jsp")}function i(D){if(D<0){D=0}else{if(D>g){D=g}}x=D;h.css("top",D);p.scrollTop(0);var E=D/g;z.css("top",-E*(w-m))}function r(){p.bind("mousewheel.jsp",function(D,F){var E=x;i(x-F*y.mouseWheelSpeed);return E==x})}function o(){p.unbind("mousewheel.jsp")}b.extend(l,{reinitialise:function(D){u(D)}})}f=b.extend({},b.fn.jScrollPane.defaults,f);var e;this.each(function(){var g=b(this);var h=g.data("jsp");if(h){h.reinitialise(f)}else{h=new d(g,f);g.data("jsp",h)}e=e?e.add(g):g});return e};b.fn.jScrollPane.defaults={showArrows:false,gutter:4,mouseWheelSpeed:10}})(jQuery,this);