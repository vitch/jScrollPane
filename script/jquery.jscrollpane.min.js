/*
 * jScrollPane - v2.0.0beta1 - 2010-08-03
 * http://jscrollpane.kelvinluck.com/
 *
 * Copyright (c) 2010 Kelvin Luck
 * Dual licensed under the MIT and GPL licenses.
 */
(function(b,a,c){b.fn.jScrollPane=function(f){function d(S,X){var g=this,Q,z,I,ab,L,W,P,v,n,aa,j,M,r,m,Z,u,G,R,K,l,J,t,N,w,y,F,o,k,B,q,Y;z={};A(X);function A(ac){var ae,ad;if(Q==c){S.css("overflow","hidden");I=S.innerWidth();ab=S.innerHeight();Q=b('<div class="jspPane" />').wrap(b('<div class="jspContainer" />').css({width:I+"px",height:ab+"px"}));S.css("overflow","visible");S.wrap(Q.parent());Q=S.parent();L=Q.parent();S.find(":first-child").addClass("jspFirst");S.find(":last-child").addClass("jspLast")}else{I=L.outerWidth();ab=L.outerHeight();L.find(".jspVerticalBar,.jspHorizontalBar").remove().end()}S.css({width:"auto",height:"auto"});ae=S.clone().css("position","absolute");ad=b('<div style="width:1px; position: relative;" />').append(ae);b("body").append(ad);W=Math.max(S.outerWidth(),ae.outerWidth());ad.remove();P=S.outerHeight();v=W/I;n=P/ab;aa=n>1;j=v>1;if(!(j||aa)){S.removeClass("jspScrollable");Q.css("top",0);H()}else{S.addClass("jspScrollable");p();U();h()}}function p(){if(aa){L.append(b('<div class="jspVerticalBar" />').append(b('<div class="jspCap jspCapTop" />'),b('<div class="jspTrack" />').append(b('<div class="jspDrag" />').append(b('<div class="jspDragTop" />'),b('<div class="jspDragBottom" />'))),b('<div class="jspCap jspCapBottom" />')));R=L.find(">.jspVerticalBar");K=R.find(">.jspTrack");M=K.find(">.jspDrag");if(X.showArrows){N=b('<a href="#" class="jspArrow jspArrowUp">Scroll up</a>').bind("mousedown.jsp",x(0,-1)).bind("click.jsp",T);w=b('<a href="#" class="jspArrow jspArrowDown">Scroll down</a>').bind("mousedown.jsp",x(0,1)).bind("click.jsp",T);K.before(N).after(w)}J=ab;L.find(">.jspVerticalBar>.jspCap:visible,>.jspVerticalBar>.jspArrow").each(function(){J-=b(this).outerHeight()});M.hover(function(){M.addClass("jspHover")},function(){M.removeClass("jspHover")}).bind("mousedown.jsp",function(ad){b("html").bind("dragstart.jsp selectstart.jsp",function(){return false});var ac=ad.pageY-M.position().top;b("html").bind("mousemove.jsp",function(ae){C(ae.pageY-ac)}).bind("mouseup.jsp mouseleave.jsp",s);return false});E();i()}else{H()}}function E(){K.height(J+"px");m=0;l=X.verticalGutter+K.outerWidth();Q.width(I-l);if(R.position().left==0){Q.css("margin-left",l+"px")}}function U(){if(j){L.append(b('<div class="jspHorizontalBar" />').append(b('<div class="jspCap jspCapLeft" />'),b('<div class="jspTrack" />').append(b('<div class="jspDrag" />').append(b('<div class="jspDragLeft" />'),b('<div class="jspDragRight" />'))),b('<div class="jspCap jspCapRight" />')));y=L.find(">.jspHorizontalBar");F=y.find(">.jspTrack");Z=F.find(">.jspDrag");if(X.showArrows){q=b('<a href="#" class="jspArrow jspArrowLeft">Scroll left</a>').bind("mousedown.jsp",x(-1,0)).bind("click.jsp",T);Y=b('<a href="#" class="jspArrow jspArrowRight">Scroll right</a>').bind("mousedown.jsp",x(1,0)).bind("click.jsp",T);F.before(q).after(Y)}Z.hover(function(){Z.addClass("jspHover")},function(){Z.removeClass("jspHover")}).bind("mousedown.jsp",function(ad){b("html").bind("dragstart.jsp selectstart.jsp",function(){return false});var ac=ad.pageX-Z.position().left;b("html").bind("mousemove.jsp",function(ae){D(ae.pageX-ac)}).bind("mouseup.jsp mouseleave.jsp",s);return false});O()}else{}}function O(){o=X.horizontalGutter+F.outerHeight();Q.height(ab-o);k=L.innerWidth();L.find(">.jspHorizontalBar>.jspCap:visible,>.jspHorizontalBar>.jspArrow").each(function(){k-=b(this).outerWidth()});F.width(k+"px");G=0}function h(){if(j&&aa){}if(j){Q.width=S.outerWidth()}P=S.outerHeight();n=P/ab;if(j){B=1/v*k;Z.width(B+"px");u=k-B}if(aa){t=1/n*J;M.height(t+"px");r=J-t}}function x(ad,ac){return function(){V(ad,ac);this.blur();return false}}function V(ae,ac){var ad=setInterval(function(){if(ae!=0){D(G+ae*X.arrowButtonSpeed)}if(ac!=0){C(m+ac*X.arrowButtonSpeed)}},X.arrowRepeatFreq);b("html").bind("mouseup.jsp",function(){clearInterval(ad);
b("html").unbind("mouseup.jsp")})}function s(){b("html").unbind("dragstart.jsp selectstart.jsp mousemove.jsp mouseup.jsp mouseleave.jsp")}function C(ac){if(ac<0){ac=0}else{if(ac>r){ac=r}}m=ac;M.css("top",ac);L.scrollTop(0);var ad=ac/r;Q.css("top",-ad*(P-ab))}function D(ac){if(ac<0){ac=0}else{if(ac>u){ac=u}}G=ac;Z.css("left",ac);L.scrollTop(0);var ad=ac/u;Q.css("left",-ad*(W-I))}function i(){L.bind("mousewheel.jsp",function(ac,ae){var ad=m;C(m-ae*X.mouseWheelSpeed);return ad==m})}function H(){L.unbind("mousewheel.jsp")}function T(){return false}b.extend(g,{reinitialise:function(ac){A(ac)}})}f=b.extend({},b.fn.jScrollPane.defaults,f);var e;this.each(function(){var g=b(this),h=g.data("jsp");if(h){h.reinitialise(f)}else{h=new d(g,f);g.data("jsp",h)}e=e?e.add(g):g});return e};b.fn.jScrollPane.defaults={showArrows:false,verticalGutter:4,horizontalGutter:4,mouseWheelSpeed:10,arrowButtonSpeed:10,arrowRepeatFreq:100}})(jQuery,this);